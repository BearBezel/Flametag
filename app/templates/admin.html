{% extends "base.html" %}

{% block content %}
<div class="page">
<div class="page-header">
<h1 class="page-title">Admin</h1>
<p class="page-subtitle">

      Generate new FlameTag codes or import existing ones. This page is private.
</p>
</div>
<div class="panel">
<div class="panel-title">Generate codes</div>
<form method="post" action="{{ url_for('main.admin_generate') }}" class="stack">
<div>
<label>Admin key</label>
<input name="admin_key" placeholder="ADMIN_KEY from .env" />
</div>
<div>
<label>How many (max 5000)</label>
<input name="how_many" placeholder="e.g. 50" />
</div>
<div class="btn-row">
<button class="btn primary" type="submit">Generate</button>
</div>
<div class="small-note">

        Generates unique FlameTag codes in your database.
</div>
</form>
</div>
<div class="panel">
<div class="panel-title">Import codes</div>
<form method="post" action="{{ url_for('main.admin_import') }}" class="stack">
<div>
<label>Admin key</label>
<input name="admin_key" placeholder="ADMIN_KEY from .env" />
</div>
<div>
<label>Tokens (one per line)</label>
<textarea name="tokens" placeholder="AB12CD34&#10;EF56GH78"></textarea>
</div>
<div class="btn-row">
<button class="btn primary" type="submit">Import</button>
<a class="btn secondary" href="{{ url_for('main.home') }}">Back home</a>
</div>
<div class="small-note">

        Use this if you already printed/engraved codes and want to load them into FlameTag.
</div>
</form>
</div>
</div>

{% if created %}
<div class="panel">
  <div class="panel-title">Recently generated codes</div>

  <div class="stack">
    {% for token in created %}
      <div style="display:flex; align-items:center; justify-content:space-between;">
        <span class="code">{{ token }}</span>

        <a href="{{ url_for('main.qr_code', token=token) }}" target="_blank">
          <button class="btn secondary">QR</button>
        </a>
      </div>
    {% endfor %}
  </div>

  <div class="small-note">
    Click QR to download a printable black-background FlameTag QR code.
  </div>
</div>
{% endif %}
<div class="panel">
<div class="panel-title">Latest QR codes</div>
<div class="small-note">
   These are the most recent tags in the database. Each QR links to the tag page.
</div>
<div class="stack" style="margin-top:12px;">
   {% for lighter in lighters %}
<div style="display:flex; gap:16px; align-items:center; padding:12px; border:1px solid rgba(255,255,255,0.08); border-radius:12px;">
<div style="width:120px; height:120px; background:#000; border-radius:12px; display:flex; align-items:center; justify-content:center; overflow:hidden;">
<img src="{{ url_for('main.qr_code', token=lighter.token) }}" alt="QR {{ lighter.token }}" style="width:110px; height:110px;" />
</div>
<div style="flex:1;">
<div style="font-weight:700; font-size:16px;">{{ lighter.token }}</div>
<div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
<a class="btn secondary" href="{{ url_for('main.lighter_page', token=lighter.token) }}" target="_blank">Open tag</a>
<a class="btn secondary" href="{{ url_for('main.qr_code', token=lighter.token) }}" target="_blank">Open QR</a>
</div>
</div>
</div>
   {% else %}
<div class="small-note">No tags found yet. Generate or import some first.</div>
   {% endfor %}
</div>
</div>
{% endblock %}
 
